# FlowSight 统一错误码与响应结构（Phase 0 - Step 5）

## 1. 统一响应结构

所有接口返回 JSON 结构统一为：

- `code`：业务状态码（沿用 HTTP 语义数字，如 `200/400/401/403/500`）
- `error_code`：稳定业务错误码（如 `FS-40110`，用于前后端稳定判断）
- `msg`：可读错误信息
- `success`：布尔值
- `time`：响应时间
- `data`：业务数据（可选）
- `rows`：列表数据（可选）

示例（失败）：

```json
{
  "code": 401,
  "error_code": "FS-40110",
  "msg": "登录信息已过期，访问系统资源失败",
  "success": false,
  "time": "2026-02-24T23:59:59"
}
```

## 2. 错误码规范

- 前缀固定：`FS-`
- 五位语义段：
  - `0xxxx` 成功
  - `4xxxx` 客户端与业务校验类错误
  - `5xxxx` 服务端错误

## 3. 标准错误码清单（v1）

| error_code | code | 说明 |
| --- | --- | --- |
| `FS-00000` | 200 | 成功 |
| `FS-40000` | 400 | 通用请求错误 |
| `FS-40010` | 400 | 登录失败 |
| `FS-42200` | 400/422 | 参数校验失败 |
| `FS-42210` | 400 | 模型校验失败 |
| `FS-42220` | 400 | 字段校验失败 |
| `FS-40100` | 401 | 未认证 |
| `FS-40110` | 401 | Token 无效或过期 |
| `FS-40300` | 403 | 无权限 |
| `FS-40310` | 403 | 权限校验失败 |
| `FS-40400` | 404 | 资源不存在 |
| `FS-40500` | 405 | 方法不允许 |
| `FS-50010` | 400/500 | 业务服务异常 |
| `FS-50000` | 500 | 系统内部异常 |

## 4. 实施要求

- 新增接口必须返回统一结构，且必须包含 `error_code`。
- 异常处理统一走全局异常处理器，不在控制器手写不一致错误格式。
- 文档变更与错误码变更必须同步提交，避免“代码先行、文档滞后”。
